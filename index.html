<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
    <link rel="stylesheet" as="style" onload="this.rel='stylesheet'" href="https://fonts.googleapis.com/css2?display=swap&family=Inter%3Awght%40400%3B500%3B700%3B900&family=Noto+Sans%3Awght%40400%3B500%3B700%3B900" />
    <title>Stitch Design</title>
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64," />
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link rel="stylesheet" href="style.css" />
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  </head>
  <body>
    <div class="relative flex size-full min-h-screen flex-col bg-[#141414] dark justify-between group/design-root overflow-x-hidden" style='font-family: Inter, "Noto Sans", sans-serif;'>
      <div id="header-container" class="flex items-center bg-[#141414] p-4 pb-2 justify-between">
        <div id="back-button" class="text-white flex size-12 shrink-0 items-center cursor-pointer hidden">
          <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
            <path d="M224,128a8,8,0,0,1-8,8H59.31l58.35,58.34a8,8,0,0,1-11.32,11.32l-72-72a8,8,0,0,1,0-11.32l72-72a8,8,0,0,1,11.32,11.32L59.31,120H216A8,8,0,0,1,224,128Z"></path>
          </svg>
        </div>
        <h2 id="page-title" class="text-white text-lg font-bold leading-tight tracking-[-0.015em] flex-1 text-center pr-12">Orbit</h2>
      </div>

      <div id="content-container" class="flex flex-1 flex-col">
        
        <div id="auth-view" class="view">
            <div class="flex flex-col items-center p-4">
                <h2 class="text-white tracking-light text-[28px] font-bold leading-tight px-4 text-center pb-3 pt-5">Welcome to Orbit</h2>
                <p class="text-white text-base font-normal leading-normal pb-3 pt-1 px-4 text-center">Sign in or create an account to get started.</p>
                
                <div class="w-full max-w-sm flex flex-col gap-4 mt-6">
                    <label class="flex flex-col min-w-40 flex-1 text-white">
                        Email
                        <input id="email-input" type="email" placeholder="email@example.com" class="form-input flex w-full min-w-0 flex-1 rounded-xl text-white focus:outline-0 focus:ring-0 border border-[#474747] bg-[#212121] focus:border-[#474747] h-12 placeholder:text-[#ababab] p-[15px] text-base font-normal leading-normal" />
                    </label>
                    <label class="flex flex-col min-w-40 flex-1 text-white">
                        Password
                        <input id="password-input" type="password" placeholder="••••••••" class="form-input flex w-full min-w-0 flex-1 rounded-xl text-white focus:outline-0 focus:ring-0 border border-[#474747] bg-[#212121] focus:border-[#474747] h-12 placeholder:text-[#ababab] p-[15px] text-base font-normal leading-normal" />
                    </label>
                    <button id="signin-btn" class="flex min-w-[84px] cursor-pointer items-center justify-center overflow-hidden rounded-xl h-12 px-5 bg-black text-white text-base font-bold leading-normal tracking-[0.015em] w-full">
                        <span class="truncate">Sign In</span>
                    </button>
                    <button id="signup-btn" class="flex min-w-[84px] cursor-pointer items-center justify-center overflow-hidden rounded-xl h-12 px-5 bg-[#303030] text-white text-base font-bold leading-normal tracking-[0.015em] w-full">
                        <span class="truncate">Sign Up</span>
                    </button>
                    <p id="auth-error-message" class="text-red-500 text-sm text-center hidden"></p>
                </div>
            </div>
        </div>

        <div id="home-view" class="view hidden">
          <h2 class="text-white tracking-light text-[28px] font-bold leading-tight px-4 text-center pb-3 pt-5">Orbit</h2>
          <p class="text-white text-base font-normal leading-normal pb-3 pt-1 px-4 text-center">Study Smarter with Orbit</p>
          <div class="flex justify-center">
            <div class="flex flex-1 gap-3 max-w-[480px] flex-col items-stretch px-4 py-3">
              <button id="pomodoro-link" class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-xl h-12 px-5 bg-black text-white text-base font-bold leading-normal tracking-[0.015em] w-full">
                <span class="truncate">Pomodoro Timer</span>
              </button>
              <button id="flashcards-link" class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-xl h-12 px-5 bg-[#303030] text-white text-base font-bold leading-normal tracking-[0.015em] w-full">
                <span class="truncate">Flashcards</span>
              </button>
            </div>
          </div>
        </div>

        <div id="pomodoro-view" class="view hidden">
          <div class="flex flex-col items-center">
            <h3 class="text-white tracking-light text-2xl font-bold leading-tight px-4 text-center pb-2 pt-5">Orbit Buddy</h3>
            <div class="flex justify-center py-4">
              <div id="liquid-orb-container" class="relative w-32 h-32 rounded-full border-4 border-white overflow-hidden">
                <div id="liquid-fill" class="absolute bottom-0 left-0 w-full bg-blue-500 transition-all duration-1000 ease-linear"></div>
                <img id="orb-image" class="absolute w-full h-full object-cover z-10 animate-pulse-slow" src="smallglow.jpg" alt="Glowing Orb" />
              </div>
            </div>
            <p class="text-[#ababab] text-sm font-normal leading-normal pb-3 pt-1 px-4 text-center">Small glowing orb/planet icon above timer with pulse animation</p>
          </div>
          <div class="flex flex-col items-center gap-4 py-3">
            <div class="flex gap-4">
              <label class="flex flex-col text-white">
                Session Time
                <input id="session-input" type="number" min="1" value="25" class="bg-[#303030] text-white rounded-xl h-10 px-4 mt-1 w-32" />
              </label>
              <label class="flex flex-col text-white">
                Break Time
                <input id="break-input" type="number" min="1" value="5" class="bg-[#303030] text-white rounded-xl h-10 px-4 mt-1 w-32" />
              </label>
            </div>
            <div class="flex gap-4 w-full px-4">
              <div class="flex grow basis-0 flex-col items-stretch gap-4">
                <div class="flex h-14 grow items-center justify-center rounded-xl px-3 bg-[#303030]">
                  <p id="minutes" class="text-white text-lg font-bold leading-tight tracking-[-0.015em]">25</p>
                </div>
                <div class="flex items-center justify-center"><p class="text-white text-sm font-normal leading-normal">Minutes</p></div>
              </div>
              <div class="flex grow basis-0 flex-col items-stretch gap-4">
                <div class="flex h-14 grow items-center justify-center rounded-xl px-3 bg-[#303030]">
                  <p id="seconds" class="text-white text-lg font-bold leading-tight tracking-[-0.015em]">00</p>
                </div>
                <div class="flex items-center justify-center"><p class="text-white text-sm font-normal leading-normal">Seconds</p></div>
              </div>
            </div>
          </div>
          <div class="flex justify-center">
            <div class="flex flex-1 gap-3 flex-wrap px-4 py-3 max-w-[480px] justify-center">
              <button id="timer-start-pause" class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-xl h-10 px-4 bg-black text-white text-sm font-bold leading-normal tracking-[0.015em] grow">
                <span class="truncate">Start</span>
              </button>
              <button id="timer-reset" class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-xl h-10 px-4 bg-[#303030] text-white text-sm font-bold leading-normal tracking-[0.015em] grow">
                <span class="truncate">Reset</span>
              </button>
            </div>
          </div>
          <h3 class="text-white text-lg font-bold leading-tight tracking-[-0.015em] px-4 pb-2 pt-4">Stats</h3>
          <div class="p-4">
            <div class="flex justify-between gap-x-6 py-2">
              <p class="text-[#ababab] text-sm font-normal leading-normal">Completed Sessions</p>
              <p id="completed-sessions" class="text-white text-sm font-normal leading-normal text-right">0</p>
            </div>
            <div class="flex justify-between gap-x-6 py-2">
              <p class="text-[#ababab] text-sm font-normal leading-normal">Current Streak</p>
              <p id="current-streak" class="text-white text-sm font-normal leading-normal text-right">0</p>
            </div>
          </div>
          <div class="flex flex-col gap-3 p-4">
            <div class="flex gap-6 justify-between"><p class="text-white text-base font-medium leading-normal">Progress</p></div>
            <div class="rounded bg-[#474747]"><div id="progress-bar" class="h-2 rounded bg-white" style="width: 0%;"></div></div>
          </div>
          
          <h3 class="text-white text-lg font-bold leading-tight tracking-[-0.015em] px-4 pb-2 pt-4">Daily Tasks</h3>
          <div class="flex flex-1 gap-3 max-w-[480px] flex-col items-stretch px-4 py-3">
            <div class="flex gap-2">
              <input id="new-task-input" type="text" placeholder="Add a new task..." class="form-input flex w-full min-w-0 flex-1 rounded-xl text-white focus:outline-0 focus:ring-0 border border-[#474747] bg-[#212121] focus:border-[#474747] h-12 placeholder:text-[#ababab] p-[15px] text-base font-normal leading-normal" />
              <button id="add-task-btn" class="flex items-center justify-center overflow-hidden rounded-xl h-12 px-4 bg-black text-white text-base font-bold leading-normal tracking-[0.015em]">
                <span class="truncate">+</span>
              </button>
            </div>
            <div id="task-list" class="flex flex-col gap-2">
              </div>
          </div>

        </div>

        <div id="flashcards-view" class="view hidden">
          <div class="pb-3">
            <div class="flex border-b border-[#474747] px-4 gap-8">
              <a id="ai-tab" class="flex flex-col items-center justify-center border-b-[3px] text-white pb-[13px] pt-4 border-b-white" href="#" data-tab="ai">
                <p class="text-sm font-bold leading-normal tracking-[0.015em]">AI Flashcards</p>
              </a>
              <a id="manual-tab" class="flex flex-col items-center justify-center border-b-[3px] text-[#ababab] pb-[13px] pt-4 border-b-transparent" href="#" data-tab="manual">
                <p class="text-sm font-bold leading-normal tracking-[0.015em]">Manual Flashcards</p>
              </a>
            </div>
          </div>

          <div id="ai-flashcards-tab" class="tab-view">
            <div class="flex max-w-[480px] flex-wrap items-end gap-4 px-4 py-3">
              <label class="flex flex-col min-w-40 flex-1">
                <textarea id="notes-input" placeholder="Paste notes here..." class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-xl text-white focus:outline-0 focus:ring-0 border border-[#474747] bg-[#212121] focus:border-[#474747] min-h-36 placeholder:text-[#ababab] p-[15px] text-base font-normal leading-normal"></textarea>
              </label>
            </div>
            <div class="flex px-4 py-3 justify-end">
              <button id="generate-btn" class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-xl h-10 px-4 bg-black text-white text-sm font-bold leading-normal tracking-[0.015em]">
                <span class="truncate">Generate Flashcards with AI</span>
              </button>
            </div>
          </div>

          <div id="manual-flashcards-tab" class="tab-view hidden">
            <div class="flex max-w-[480px] flex-wrap items-end gap-4 px-4 py-3">
              <label class="flex flex-col min-w-40 flex-1">
                <input id="question-input" placeholder="Question" class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-xl text-white focus:outline-0 focus:ring-0 border border-[#474747] bg-[#212121] focus:border-[#474747] h-14 placeholder:text-[#ababab] p-[15px] text-base font-normal leading-normal" value=""/>
              </label>
            </div>
            <div class="flex max-w-[480px] flex-wrap items-end gap-4 px-4 py-3">
              <label class="flex flex-col min-w-40 flex-1">
                <input id="answer-input" placeholder="Answer" class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-xl text-white focus:outline-0 focus:ring-0 border border-[#474744] h-14 placeholder:text-[#ababab] p-[15px] text-base font-normal leading-normal" value=""/>
              </label>
            </div>
            <div class="flex px-4 py-3 justify-end">
              <button id="save-flashcard-btn" class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-xl h-10 px-4 bg-black text-white text-sm font-bold leading-normal tracking-[0.015em]">
                <span class="truncate">Save</span>
              </button>
            </div>
          </div>

          <h3 class="text-white text-lg font-bold leading-tight tracking-[-0.015em] px-4 pb-2 pt-4">Flashcards</h3>
          <div id="flashcards-grid" class="grid grid-cols-[repeat(auto-fit,minmax(158px,1fr))] gap-3 p-4">
            <div class="flashcard-item bg-cover bg-center flex flex-col gap-3 rounded-xl justify-end p-4 aspect-square cursor-pointer" style='background-image: linear-gradient(0deg, rgba(0, 0, 0, 0.4) 0%, rgba(0, 0, 0, 0) 100%, rgba(0, 0, 0, 0.1) 100%, rgba(0, 0, 0, 0) 100%), url("https://lh3.googleusercontent.com/aida-public/AB6AXuD9EOJYb4hokMZbkzYu7BuBnQidCiacf9oS7xKVqqfNDz5TWX7gUSNNt3zhUzD_1tbhVdRVxr7mVEWJsoHFkbLs6RP2PJCyWIS0zAap3bIDLTkWeXu50o5IeH0WoU6oCj5komJOh1XhcVoZeASIkn0DgxTt7QewFxITvRO3azMcpu53TE2isUzd5lAoR-igWyIQFW_PvviM5a5ZUeUAca9ts0E09eotRocG1lQVJzczu36L9GuCTTs2pQw-ig0bDdy9KKLWVx0HHIfT");' data-question="What is the capital of France?" data-answer="Paris">
              <p class="text-white text-base font-bold leading-tight w-4/5 line-clamp-2">What is the capital of France?</p>
            </div>
          </div>
        </div>

        <div id="review-view" class="view hidden">
          <div class="p-4 @container">
            <div class="flex flex-col items-stretch justify-start rounded-xl @xl:flex-row @xl:items-start">
              <div class="w-full bg-center bg-no-repeat aspect-video bg-cover rounded-xl" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuDcdYbg_-Ekmf4zV8inC7DRhOCnqSiHQFa3ZSOLoqRTEzO6jgFL_BaSiFpDfDpqIkoi9JJ7hveFt0pfRq4NoxWqsQPE82IsyKbw4eAqP4sqjiRgwekhuEYipDLF3vvqTDe0XK2qPcnA-_4CWxq2B-NXaVuYD7ZSNkd9a_ErYTHZciUzxJ8PNHj6SlTM5MrmjCb36mFKym6fwsIbF5xtVYsrO5sxZC93GOOwLdkoqkfCG3ECafPvmjBk_jOJ12MZOXmnzRz2749lLclZ");'></div>
              <div class="flex w-full min-w-72 grow flex-col items-stretch justify-center gap-1 py-4 @xl:px-4">
                <p id="review-question" class="text-white text-lg font-bold leading-tight tracking-[-0.015em]">Question</p>
                <div class="flex items-end gap-3 justify-between">
                  <p id="review-answer" class="text-[#ababab] text-base font-normal leading-normal hidden">Answer</p>
                </div>
                <button id="show-answer-btn" class="mt-4 flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-xl h-10 px-4 bg-black text-white text-sm font-bold leading-normal tracking-[0.015em]">
                  <span class="truncate">Show Answer</span>
                </button>
              </div>
            </div>
          </div>
        </div>

        <div id="profile-view" class="view hidden">
          <div class="flex p-4 @container">
            <div class="flex w-full flex-col gap-4 items-center">
              <div class="flex gap-4 flex-col items-center">
                <div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full min-h-32 w-32" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuDfedJ8kac2bFKIhyWZLN3VQRt5kUDmmE_FHdjAm5--HJkaFuhI466ZiJr-UeBDgihaUc-uTeYc4K_5TAMwlebXraHvuRnNYYNGbvb3uDTgqovZ-W2PcoG15wn81yEnpey8rRZHbrDa1o0b-Hm8LqfULAYz4z7LRWE6EnBJD1aqZk5OcJ0bwRUxljC1UaHlVeO6e4u7d3_YEBsW9YX4Knhivf0NKYTO90PgZT90Bw5-vv8JafZ8edrWtRFmdEJuKBuxZgl34LJCz4RR");'></div>
                <div class="flex flex-col items-center justify-center justify-center">
                  <p id="user-email" class="text-white text-[22px] font-bold leading-tight tracking-[-0.015em] text-center">User Email</p>
                  <p class="text-[#ababab] text-base font-normal leading-normal text-center">ethan.carter@email.com</p>
                </div>
              </div>
            </div>
          </div>
          <h3 class="text-white text-lg font-bold leading-tight tracking-[-0.015em] px-4 pb-2 pt-4">Your Orbit</h3>
          <div class="flex items-center gap-4 bg-[#141414] px-4 min-h-[72px] py-2">
            <div class="text-white flex items-center justify-center rounded-lg bg-[#303030] shrink-0 size-12" data-icon="Sparkle" data-size="24px" data-weight="regular">
              <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                <path d="M197.58,129.06l-51.61-19-19-51.65a15.92,15.92,0,0,0-29.88,0L78.07,110l-51.65,19a15.92,15.92,0,0,0,0,29.88L78,178l19,51.62a15.92,15.92,0,0,0,29.88,0l19-51.61,51.65-19a15.92,15.92,0,0,0,0-29.88ZM140.39,163a15.87,15.87,0,0,0-9.43,9.43l-19,51.46L93,172.39A15.87,15.87,0,0,0,83.61,163h0L32.15,144l51.46-19A15.87,15.87,0,0,0,93,115.61l19-51.46,19,51.46a15.87,15.87,0,0,0,9.43,9.43l51.46,19ZM144,40a8,8,0,0,1,8-8h16V16a8,8,0,0,1,16,0V32h16a8,8,0,0,1,0,16H184V64a8,8,0,0,1-16,0V48H152A8,8,0,0,1,144,40ZM248,88a8,8,0,0,1-8,8h-8v8a8,8,0,0,1-16,0V96h-8a8,8,0,0,1,0-16h8V72a8,8,0,0,1,16,0v8h8A8,8,0,0,1,248,88Z"></path>
              </svg>
            </div>
            <div class="flex flex-col justify-center">
              <p class="text-white text-base font-medium leading-normal line-clamp-1">AI Credits</p>
              <p class="text-[#ababab] text-sm font-normal leading-normal line-clamp-2">1000 credits remaining</p>
            </div>
          </div>
          <div class="p-4 @container">
            <div class="flex flex-1 flex-col items-start justify-between gap-4 rounded-xl border border-[#474747] bg-[#141414] p-5 @[480px]:flex-row @[480px]:items-center">
              <div class="flex flex-col gap-1">
                <p class="text-white text-base font-bold leading-tight">Upgrade your plan</p>
                <p class="text-[#ababab] text-base font-normal leading-normal">Unlock more features and increase your AI credit limit.</p>
              </div>
              <button class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-xl h-8 px-4 bg-black text-white text-sm font-medium leading-normal">
                <span class="truncate">Upgrade</span>
              </button>
            </div>
          </div>
          <div class="flex justify-center p-4">
            <button id="signout-btn" class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-xl h-12 px-5 bg-red-600 text-white text-base font-bold leading-normal tracking-[0.015em] w-full">
                <span class="truncate">Sign Out</span>
            </button>
          </div>
        </div>

        <div id="ai-chat-view" class="view hidden flex-col">
          <div class="flex items-center bg-[#1a1a1a] p-4 pb-2 justify-between">
            <h2 class="text-white text-lg font-bold leading-tight tracking-[-0.015em] flex-1 text-center pr-12">ORBIT AI</h2>
          </div>
          <div id="messages-container" class="flex-1 overflow-y-auto p-4 flex flex-col gap-4">
            <div class="flex items-end gap-3">
              <div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full w-10 shrink-0" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuCmSn291Ma1ahSA1ATxsH6vhk5HZaCSQIFiH_mmuBD8wONT0jO3N64IAeqPc_qBeffj-exgY4lFxNTbrSeKUeqJWEbi0uHNHOsprrYLHEkrkhsNbLgpRkVY_-RwA9dl2KX9jlpKfqqXkcYj25PaEoOH0v1dmL1npL2DAbHPKak4V3mswRk6oUudH__prs5lRJFrFQNAIdkYvG6E7U94jsu9m-GLe0Taq4RfZOjGN4wkGFsBEnRmGxV1XXtscFiKVIdaBphQajfHKr1K");'></div>
              <div class="flex flex-1 flex-col gap-1 items-start">
                <p class="text-[#adadad] text-[13px] font-normal leading-normal max-w-[360px]">ORBIT AI</p>
                <p class="text-base font-normal leading-normal flex max-w-[360px] rounded-xl px-4 py-3 bg-[#363636] text-white">
                  Hey there! How can I help you with your studies today?
                </p>
              </div>
            </div>
          </div>
          <div>
          <div class="flex items-center px-4 py-3 gap-3 @container">
  <label class="flex flex-col min-w-40 h-12 flex-1">
    <div class="flex w-full flex-1 items-stretch rounded-xl h-full">
      <input
        id="chat-input"
        placeholder="Ask anything about your notes..."
        class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-xl text-white focus:outline-0 focus:ring-0 border-none bg-[#363636] focus:border-none h-full placeholder:text-[#adadad] px-4 rounded-r-none border-r-0 pr-2 text-base font-normal leading-normal"
        value=""
      />
      <div class="flex border-none bg-[#363636] items-center justify-center pr-4 rounded-r-xl border-l-0">
        <button id="send-chat-btn" class="flex items-center justify-center overflow-hidden rounded-xl h-8 px-4 bg-black text-white text-sm font-medium leading-normal shrink-0">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" fill="currentColor" width="24" height="24">
            <path d="M224,40a8,8,0,0,1,8,8V180.24a8,8,0,0,1-13.66,5.65L120,111.31V216a8,8,0,0,1-4.83,7.49A7.83,7.83,0,0,1,112,224a8,8,0,0,1-7.42-4.88L33,65.65a8,8,0,0,1,12.33-9.59L216,160.71V48A8,8,0,0,1,224,40Z"></path>
          </svg>
        </button>
      </div>
    </div>
  </label>
</div>
          </div>
        </div>

      </div>

      <div>
        <div class="flex gap-2 border-t border-[#303030] bg-[#212121] px-4 pb-3 pt-2">
          <a class="nav-link just flex flex-1 flex-col items-center justify-end gap-1 rounded-full text-white" href="#" data-view="home-view">
            <div class="text-white flex h-8 items-center justify-center">
              <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                <path d="M224,115.55V208a16,16,0,0,1-16,16H168a16,16,0,0,1-16-16V168a8,8,0,0,0-8-8H112a8,8,0,0,0-8,8v40a16,16,0,0,1-16,16H48a16,16,0,0,1-16-16V115.55a16,16,0,0,1,5.17-11.78l80-75.48.11-.11a16,16,0,0,1,21.53,0,1.14,1.14,0,0,0,.11.11l80,75.48A16,16,0,0,1,224,115.55Z"></path>
              </svg>
            </div>
          </a>
          <a class="nav-link just flex flex-1 flex-col items-center justify-end gap-1 text-[#ababab]" href="#" data-view="pomodoro-view">
            <div class="text-[#ababab] flex h-8 items-center justify-center">
              <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                <path d="M128,40a96,96,0,1,0,96,96A96.11,96.11,0,0,0,128,40Zm0,176a80,80,0,1,1,80-80A80.09,80.09,0,0,1,128,216ZM173.66,90.34a8,8,0,0,1,0,11.32l-40,40a8,8,0,0,1-11.32-11.32l40-40A8,8,0,0,1,173.66,90.34ZM96,16a8,8,0,0,1,8-8h48a8,8,0,0,1,0,16H104A8,8,0,0,1,96,16Z"></path>
              </svg>
            </div>
          </a>
          <a class="nav-link just flex flex-1 flex-col items-center justify-end gap-1 text-[#ababab]" href="#" data-view="flashcards-view">
            <div class="text-[#ababab] flex h-8 items-center justify-center">
              <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                <path d="M184,72H40A16,16,0,0,0,24,88V200a16,16,0,0,0,16,16H184a16,16,0,0,0,16-16V88A16,16,0,0,0,184,72Zm0,128H40V88H184V200ZM232,56V176a8,8,0,0,1-16,0V56H64a8,8,0,0,1,0-16H216A16,16,0,0,1,232,56Z"></path>
              </svg>
            </div>
          </a>
          <a class="nav-link just flex flex-1 flex-col items-center justify-end gap-1 text-[#ababab]" href="#" data-view="ai-chat-view">
            <div class="text-[#ababab] flex h-8 items-center justify-center">
              <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                <path d="M216,40H40A16,16,0,0,0,24,56V216a16,16,0,0,0,16,16h88.08L216,240V224.28A15.89,15.89,0,0,0,232,208.43V56A16,16,0,0,0,216,40ZM40,56H216V208.43L128,184.28a16.14,16.14,0,0,0-10.45,1.21L96,189.66V216H40Z"></path>
              </svg>
            </div>
          </a>
          <a class="nav-link just flex flex-1 flex-col items-center justify-end gap-1 text-[#ababab]" href="#" data-view="profile-view">
            <div class="text-[#ababab] flex h-8 items-center justify-center">
              <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                <path d="M230.92,212c-15.23-26.33-38.7-45.21-66.09-54.16a72,72,0,1,0-73.66,0C63.78,166.78,40.31,185.66,25.08,212a8,8,0,1,0,13.85,8c18.84-32.56,52.14-52,89.07-52s70.23,19.44,89.07,52a8,8,0,1,0,13.85-8ZM72,96a56,56,0,1,1,56,56A56.06,56.06,0,0,1,72,96Z"></path>
              </svg>
            </div>
          </a>
        </div>
        <div class="h-5 bg-[#212121]"></div>
      </div>
    </div>
    
    <div id="ad-modal" class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50">
      <div class="bg-[#212121] rounded-xl p-6 relative w-full max-w-xl">
        <button id="close-ad-btn" class="absolute top-2 right-2 text-white text-xl">
          ×
        </button>
        <div class="flex flex-col gap-4">
          <h3 class="text-white text-lg font-bold text-center" id="ad-title">Video Ad</h3>
          <video id="ad-player" controls autoplay muted class="rounded-lg w-full">
            Your browser does not support the video tag.
          </video>
          <p class="text-[#ababab] text-sm font-normal text-center" id="ad-description"></p>
        </div>
      </div>
    </div>

<script>
    // Local Authentication Logic (replaces Supabase)
    const authView = document.getElementById('auth-view');
    const homeView = document.getElementById('home-view');
    const pomodoroView = document.getElementById('pomodoro-view');
    const flashcardsView = document.getElementById('flashcards-view');
    const profileView = document.getElementById('profile-view');
    const aiChatView = document.getElementById('ai-chat-view');
    const emailInput = document.getElementById('email-input');
    const passwordInput = document.getElementById('password-input');
    const signInBtn = document.getElementById('signin-btn');
    const signUpBtn = document.getElementById('signup-btn');
    const signOutBtn = document.getElementById('signout-btn');
    const authErrorMsg = document.getElementById('auth-error-message');
    const userEmailEl = document.getElementById('user-email');

    let currentUser = null;

    // Function to show a specific view and hide others
    function showView(viewId) {
        document.querySelectorAll('.view').forEach(view => {
            view.classList.add('hidden');
        });
        document.getElementById(viewId).classList.remove('hidden');
        updateHeaderAndFooter(viewId);
    }
  
    function updateHeaderAndFooter(viewId) {
        const pageTitle = document.getElementById('page-title');
        const backButton = document.getElementById('back-button');
        const navLinks = document.querySelectorAll('.nav-link');
  
        if (viewId === 'home-view') {
            pageTitle.textContent = 'Orbit';
            backButton.classList.add('hidden');
        } else if (viewId === 'pomodoro-view') {
            pageTitle.textContent = 'Pomodoro';
            backButton.classList.remove('hidden');
        } else if (viewId === 'flashcards-view') {
            pageTitle.textContent = 'Flashcards';
            backButton.classList.remove('hidden');
        } else if (viewId === 'profile-view') {
            pageTitle.textContent = 'Profile';
            backButton.classList.remove('hidden');
        } else if (viewId === 'ai-chat-view') {
            pageTitle.textContent = 'ORBIT AI';
            backButton.classList.remove('hidden');
        } else if (viewId === 'auth-view') {
            pageTitle.textContent = 'Orbit';
            backButton.classList.add('hidden');
        }

        navLinks.forEach(link => {
            if (link.dataset.view === viewId) {
                link.classList.remove('text-[#ababab]');
                link.classList.add('text-white');
            } else {
                link.classList.remove('text-white');
                link.classList.add('text-[#ababab]');
            }
        });
    }
  
    // Event listeners for navigation
    document.querySelectorAll('.nav-link').forEach(link => {
        link.addEventListener('click', (e) => {
            e.preventDefault();
            if (currentUser) {
                showView(e.currentTarget.dataset.view);
            } else {
                showView('auth-view');
            }
        });
    });
  
    // Back button functionality
    document.getElementById('back-button').addEventListener('click', () => {
        showView('home-view');
    });
  
    // LOCAL AUTHENTICATION
    async function handleSignIn(e) {
        e.preventDefault();
        const email = emailInput.value;
        const password = passwordInput.value;
        authErrorMsg.textContent = '';
        authErrorMsg.classList.add('hidden');

        // Retrieve user from local storage
        const storedUser = JSON.parse(localStorage.getItem('user'));
        
        if (storedUser && storedUser.email === email && storedUser.password === password) {
            currentUser = storedUser;
            userEmailEl.textContent = currentUser.email;
            showView('home-view');
            console.log('User signed in:', currentUser.email);
        } else {
            authErrorMsg.textContent = 'Invalid email or password.';
            authErrorMsg.classList.remove('hidden');
            console.error('Sign-in failed.');
        }
    }

    async function handleSignUp(e) {
        e.preventDefault();
        const email = emailInput.value;
        const password = passwordInput.value;
        authErrorMsg.textContent = '';
        authErrorMsg.classList.add('hidden');
        
        if (!email || !password) {
          authErrorMsg.textContent = 'Email and password cannot be empty.';
          authErrorMsg.classList.remove('hidden');
          return;
        }

        const storedUser = JSON.parse(localStorage.getItem('user'));
        
        if (storedUser && storedUser.email === email) {
            authErrorMsg.textContent = 'An account with this email already exists.';
            authErrorMsg.classList.remove('hidden');
            return;
        }

        // Store new user in local storage
        const newUser = { email, password };
        localStorage.setItem('user', JSON.stringify(newUser));
        alert('Account created successfully! Please sign in.');
        console.log('New user signed up:', email);
    }

    async function handleSignOut(e) {
        e.preventDefault();
        localStorage.removeItem('user');
        currentUser = null;
        showView('auth-view');
        console.log('User signed out.');
    }

    signInBtn.addEventListener('click', handleSignIn);
    signUpBtn.addEventListener('click', handleSignUp);
    signOutBtn.addEventListener('click', handleSignOut);

    // Check for an existing local session on page load
    function checkSession() {
        const storedUser = JSON.parse(localStorage.getItem('user'));
        if (storedUser) {
            currentUser = storedUser;
            userEmailEl.textContent = currentUser.email;
            showView('home-view');
        } else {
            showView('auth-view');
        }
    }
    checkSession();

    // Pomodoro Timer Logic
    const minutesEl = document.getElementById('minutes');
    const secondsEl = document.getElementById('seconds');
    const startPauseBtn = document.getElementById('timer-start-pause');
    const resetBtn = document.getElementById('timer-reset');
    const sessionInput = document.getElementById('session-input');
    const breakInput = document.getElementById('break-input');
    const progressBar = document.getElementById('progress-bar');
    const liquidFill = document.getElementById('liquid-fill');
    const completedSessionsEl = document.getElementById('completed-sessions');
    const currentStreakEl = document.getElementById('current-streak');
    
    let timer;
    let isRunning = false;
    let isSession = true;
    let timeRemaining;
    let completedSessions = 0;
    let currentStreak = 0;
    
    function updateTimerDisplay() {
        const minutes = Math.floor(timeRemaining / 60);
        const seconds = timeRemaining % 60;
        minutesEl.textContent = String(minutes).padStart(2, '0');
        secondsEl.textContent = String(seconds).padStart(2, '0');
        updateProgressBar();
    }
    
    function updateProgressBar() {
        const totalTime = isSession ? sessionInput.value * 60 : breakInput.value * 60;
        const progress = 100 - (timeRemaining / totalTime) * 100;
        progressBar.style.width = `${progress}%`;
        liquidFill.style.height = `${progress}%`;
    }
    
    function startTimer() {
        if (isRunning) return;
        isRunning = true;
        startPauseBtn.textContent = 'Pause';
    
        timer = setInterval(() => {
            if (timeRemaining > 0) {
                timeRemaining--;
                updateTimerDisplay();
            } else {
                clearInterval(timer);
                isRunning = false;
                if (isSession) {
                    completedSessions++;
                    completedSessionsEl.textContent = completedSessions;
                    currentStreak++;
                    currentStreakEl.textContent = currentStreak;
                    isSession = false;
                    timeRemaining = breakInput.value * 60;
                    alert('Pomodoro session complete! Time for a break.');
                } else {
                    isSession = true;
                    timeRemaining = sessionInput.value * 60;
                    alert('Break complete! Time to start a new session.');
                }
                startTimer();
            }
        }, 1000);
    }
    
    function pauseTimer() {
        clearInterval(timer);
        isRunning = false;
        startPauseBtn.textContent = 'Start';
    }
    
    function resetTimer() {
        pauseTimer();
        isSession = true;
        timeRemaining = sessionInput.value * 60;
        updateTimerDisplay();
        progressBar.style.width = '0%';
        liquidFill.style.height = '0%';
        startPauseBtn.textContent = 'Start';
    }
    
    startPauseBtn.addEventListener('click', () => {
        if (isRunning) {
            pauseTimer();
        } else {
            startTimer();
        }
    });
    
    resetBtn.addEventListener('click', resetTimer);
    
    sessionInput.addEventListener('change', resetTimer);
    breakInput.addEventListener('change', resetTimer);
    
    // Initial setup
    timeRemaining = sessionInput.value * 60;
    updateTimerDisplay();
    
    // Flashcards Logic
    const aiTab = document.getElementById('ai-tab');
    const manualTab = document.getElementById('manual-tab');
    const aiFlashcardsTab = document.getElementById('ai-flashcards-tab');
    const manualFlashcardsTab = document.getElementById('manual-flashcards-tab');
    const generateBtn = document.getElementById('generate-btn');
    const notesInput = document.getElementById('notes-input');
    const flashcardsGrid = document.getElementById('flashcards-grid');
    const questionInput = document.getElementById('question-input');
    const answerInput = document.getElementById('answer-input');
    const saveFlashcardBtn = document.getElementById('save-flashcard-btn');
    
    let flashcardsData = [];
    
    function switchFlashcardTab(tab) {
        aiTab.classList.remove('border-b-white', 'text-white');
        aiTab.classList.add('border-b-transparent', 'text-[#ababab]');
        manualTab.classList.remove('border-b-white', 'text-white');
        manualTab.classList.add('border-b-transparent', 'text-[#ababab]');
    
        aiFlashcardsTab.classList.add('hidden');
        manualFlashcardsTab.classList.add('hidden');
    
        if (tab === 'ai') {
            aiTab.classList.add('border-b-white', 'text-white');
            aiFlashcardsTab.classList.remove('hidden');
        } else {
            manualTab.classList.add('border-b-white', 'text-white');
            manualFlashcardsTab.classList.remove('hidden');
        }
    }
    
    aiTab.addEventListener('click', (e) => {
        e.preventDefault();
        switchFlashcardTab('ai');
    });
    
    manualTab.addEventListener('click', (e) => {
        e.preventDefault();
        switchFlashcardTab('manual');
    });
    
    // Function to render flashcards
    function renderFlashcards() {
        flashcardsGrid.innerHTML = '';
        flashcardsData.forEach(card => {
            const cardEl = document.createElement('div');
            cardEl.className = `flashcard-item bg-cover bg-center flex flex-col gap-3 rounded-xl justify-end p-4 aspect-square cursor-pointer`;
            cardEl.style.backgroundImage = `linear-gradient(0deg, rgba(0, 0, 0, 0.4) 0%, rgba(0, 0, 0, 0) 100%), url('https://picsum.photos/300?random=${Math.random()}')`;
            cardEl.innerHTML = `<p class="text-white text-base font-bold leading-tight w-4/5 line-clamp-2">${card.question}</p>`;
            cardEl.dataset.question = card.question;
            cardEl.dataset.answer = card.answer;
            cardEl.addEventListener('click', () => {
                document.getElementById('review-question').textContent = card.question;
                document.getElementById('review-answer').textContent = card.answer;
                document.getElementById('review-answer').classList.add('hidden');
                document.getElementById('show-answer-btn').textContent = 'Show Answer';
                showView('review-view');
            });
            flashcardsGrid.appendChild(cardEl);
        });
    }
    
    // Show/Hide Answer button for review view
    const showAnswerBtn = document.getElementById('show-answer-btn');
    showAnswerBtn.addEventListener('click', () => {
        const answerEl = document.getElementById('review-answer');
        if (answerEl.classList.contains('hidden')) {
            answerEl.classList.remove('hidden');
            showAnswerBtn.textContent = 'Hide Answer';
        } else {
            answerEl.classList.add('hidden');
            showAnswerBtn.textContent = 'Show Answer';
        }
    });
    
    // AI Flashcard generation
    generateBtn.addEventListener('click', async () => {
        if (!currentUser) {
            alert('Please sign in to generate flashcards.');
            return;
        }

        const notes = notesInput.value.trim();
        if (!notes) {
            alert('Please paste your notes to generate flashcards.');
            return;
        }

        generateBtn.textContent = 'Generating...';
        generateBtn.disabled = true;

        try {
            const API_KEY = 'AIzaSyCJWhQuXnLWj5XughOMEh9gl0uu2crJNZ4';
            const API_ENDPOINT = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent';
            
            const prompt = `Generate exactly 4 flashcards (question and answer pairs) from the following notes. The response should be a JSON array of objects, where each object has a 'question' and an 'answer' key. Do not include any other text in the response. Here are the notes: ${notes}`;

            const response = await fetch(API_ENDPOINT, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'x-goog-api-key': API_KEY
                },
                body: JSON.stringify({
                    contents: [{
                        role: "user",
                        parts: [{ text: prompt }]
                    }]
                })
            });

            if (!response.ok) {
                const errorData = await response.json();
                console.error('API call failed with status:', response.status, 'and message:', errorData.error.message);
                throw new Error('API call failed: ' + errorData.error.message);
            }

            const data = await response.json();
            const apiResponseText = data.candidates[0].content.parts[0].text;
            const cleanedText = apiResponseText.replace(/```json\n|```/g, '').trim();
            const newFlashcards = JSON.parse(cleanedText);

            if (Array.isArray(newFlashcards)) {
                flashcardsData = [...flashcardsData, ...newFlashcards];
                renderFlashcards();
                alert('Flashcards generated successfully!');
            } else {
                alert('Failed to parse API response. The response was not a valid JSON array.');
            }

        } catch (error) {
            console.error('Error generating flashcards:', error);
            alert('Error generating flashcards. Please check the browser console for details.');
        } finally {
            generateBtn.textContent = 'Generate Flashcards with AI';
            generateBtn.disabled = false;
        }
    });
    
    // Manual Flashcard save
    saveFlashcardBtn.addEventListener('click', () => {
        const question = questionInput.value.trim();
        const answer = answerInput.value.trim();
    
        if (question && answer) {
            flashcardsData.push({ question, answer });
            renderFlashcards();
            questionInput.value = '';
            answerInput.value = '';
            alert('Flashcard saved successfully!');
        } else {
            alert('Please fill in both the question and answer fields.');
        }
    });
    
    // Task list logic
    const taskInput = document.getElementById('new-task-input');
    const addTaskBtn = document.getElementById('add-task-btn');
    const taskList = document.getElementById('task-list');
    
    addTaskBtn.addEventListener('click', () => {
        const taskText = taskInput.value.trim();
        if (taskText) {
            const taskItem = document.createElement('div');
            taskItem.className = 'flex items-center gap-2 p-3 bg-[#303030] rounded-xl';
            taskItem.innerHTML = `
                <input type="checkbox" class="form-checkbox text-white border-[#474747] bg-[#212121] rounded" />
                <span class="text-white flex-1">${taskText}</span>
            `;
            taskList.appendChild(taskItem);
            taskInput.value = '';
    
            const checkbox = taskItem.querySelector('input[type="checkbox"]');
            checkbox.addEventListener('change', () => {
                if (checkbox.checked) {
                    setTimeout(() => {
                        taskItem.remove();
                    }, 500);
                }
            });
        }
    });
    
    taskInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
            addTaskBtn.click();
        }
    });
    
    // ... (Your existing code for manual flashcards, task list, etc.)
    
// AI Chat logic
const chatInput = document.getElementById('chat-input');
const sendChatBtn = document.getElementById('send-chat-btn');
const messagesContainer = document.getElementById('messages-container');

async function sendMessage() {
    const chatText = chatInput.value.trim();
    if (!chatText) return;

    appendMessage('user', chatText);
    chatInput.value = '';

    // NOTE: You must replace 'YOUR_API_KEY' with your actual Google AI API key.
    const API_KEY = 'AIzaSyCJWhQuXnLWj5XughOMEh9gl0uu2crJNZ4';
    const API_ENDPOINT = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent';

    try {
        const response = await fetch(API_ENDPOINT, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'x-goog-api-key': API_KEY
            },
            body: JSON.stringify({
                contents: [{
                    role: "user",
                    parts: [{ text: chatText }]
                }]
            })
        });

        if (!response.ok) {
            const errorData = await response.json();
            throw new Error('API call failed: ' + errorData.error.message);
        }

        const data = await response.json();
        const aiResponseText = data.candidates[0].content.parts[0].text;
        appendMessage('bot', aiResponseText);

    } catch (error) {
        console.error('Error sending message:', error);
        appendMessage('bot', 'Sorry, I am unable to respond at the moment.');
    }
}

function appendMessage(sender, text) {
    const messageDiv = document.createElement('div');
    messageDiv.className = `flex items-end gap-3 ${sender === 'user' ? 'justify-end' : ''}`;

    if (sender === 'user') {
        messageDiv.innerHTML = `
            <div class="flex flex-1 flex-col gap-1 items-end">
                <p class="text-white text-base font-normal leading-normal max-w-[360px] rounded-xl px-4 py-3 bg-black">${text}</p>
            </div>
            <div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full w-10 shrink-0" style='background-image: url("https://picsum.photos/300?random=3");'></div>
        `;
    } else {
        messageDiv.innerHTML = `
            <div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full w-10 shrink-0" style='background-image: url("https://picsum.photos/300?random=4");'></div>
            <div class="flex flex-1 flex-col gap-1 items-start">
                <p class="text-[#adadad] text-[13px] font-normal leading-normal max-w-[360px]">ORBIT AI</p>
                <p class="text-base font-normal leading-normal flex max-w-[360px] rounded-xl px-4 py-3 bg-[#363636] text-white">${text}</p>
            </div>
        `;
    }
    messagesContainer.appendChild(messageDiv);
    messagesContainer.scrollTop = messagesContainer.scrollHeight;
}

sendChatBtn.addEventListener('click', sendMessage);
chatInput.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
        sendMessage();
    }
});

// This code removes elements from the DOM, so it should run after your listeners are attached.
document.querySelectorAll('#ai-chat-view .p-4').forEach((el, index) => {
    if (index > 0) el.remove();
});
